var Z=Object.defineProperty;var tt=(n,e,t)=>e in n?Z(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(tt(n,typeof e!="symbol"?e+"":e,t),t);import{i as et,j as V,q as W,l as ot,z as nt,o as E,c as P,a as f,F as st,A as rt,u as at,b as it,p as lt,d as ut,m as ct,v as dt,t as pt}from"./vendor.ee5d4042.js";import{d as ft,e as _,f as ht,g as O,G as wt,P as S,t as $,h as N,b as mt,c as yt,S as w,a as y,T as g,F as m,C as k,i as gt,L as xt,W as vt,V as M}from"./index.1124259f.js";import{c as Ft}from"./axios.07c1c759.js";import{_ as _t}from"./index.fe4cc012.js";class A extends Array{constructor(){super(...arguments);r(this,"meta")}}var Tt=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),St=function(n){Tt(e,n);function e(){return n.call(this)||this}return e.prototype.getType=function(){return ft.TEXT},e.prototype.readFeature=function(t,o){return this.readFeatureFromText(L(t),this.adaptOptions(o))},e.prototype.readFeatureFromText=function(t,o){return _()},e.prototype.readFeatures=function(t,o){return this.readFeaturesFromText(L(t),this.adaptOptions(o))},e.prototype.readFeaturesFromText=function(t,o){return _()},e.prototype.readGeometry=function(t,o){return this.readGeometryFromText(L(t),this.adaptOptions(o))},e.prototype.readGeometryFromText=function(t,o){return _()},e.prototype.readProjection=function(t){return this.readProjectionFromText(L(t))},e.prototype.readProjectionFromText=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,o){return this.writeFeatureText(t,this.adaptOptions(o))},e.prototype.writeFeatureText=function(t,o){return _()},e.prototype.writeFeatures=function(t,o){return this.writeFeaturesText(t,this.adaptOptions(o))},e.prototype.writeFeaturesText=function(t,o){return _()},e.prototype.writeGeometry=function(t,o){return this.writeGeometryText(t,this.adaptOptions(o))},e.prototype.writeGeometryText=function(t,o){return _()},e}(ht);function L(n){return typeof n=="string"?n:""}var j=St;class kt extends j{constructor(){super();this.dataProjection=O("EPSG:4326")}readFeaturesFromText(e,t){const o=Y(e),s=new A,a=this.readContour(o,t);return s.push(...a),s.meta=o.head,s}readContour(e,t){const o=e.head,s=e.data,a=e.levels,i=Ft(s,a,{pointConvert:u=>{u.x=o.beginLon+u.x*o.lonSpan,u.y=o.beginLat+u.y*o.latSpan},progressCallback:(u,d)=>{console.log(u,d)}}).smooth().toJSON(!0,!0,!0);return new wt(t).readFeatures(i)}}class Lt extends j{constructor(){super();this.dataProjection=O("EPSG:4326")}readFeaturesFromText(e,t){const o=Y(e),s=o.head,a=o.data,c=new A;for(let i=0;i<s.countLat;i++)for(let u=0;u<s.countLon;u++){const d=s.beginLon+u*s.lonSpan,h=s.beginLat+i*s.latSpan;let l=new S([d,h]);l=$(l,!1,t);const p=new N(l);p.setProperties({level:a[i][u]}),c.push(p)}return c.meta=o.head,c}}class Ct{constructor(){r(this,"diamond","");r(this,"type",4);r(this,"name","");r(this,"year",2e3);r(this,"month",1);r(this,"day",1);r(this,"hour",0);r(this,"span",0);r(this,"level",0);r(this,"lonSpan",1);r(this,"latSpan",1);r(this,"beginLon",-180);r(this,"endLon",180);r(this,"beginLat",-90);r(this,"endLat",90);r(this,"countLon",360);r(this,"countLat",180);r(this,"levelSpan",10);r(this,"levelBegin",0);r(this,"levelEnd",100);r(this,"smoothingCoefficient",0);r(this,"boldValue",0)}}function Y(n){const e=n.split(/[\s+\n+]+/),t=new Ct;let o=0;const s=t;for(let i in t)s[i]=typeof s[i]=="number"?parseFloat(e[o]):e[o],o++;if(t.diamond!="diamond"||t.type!=4)throw"\u65E0\u6CD5\u89E3\u6790\u6570\u636E\u6587\u4EF6\uFF0C\u4E0D\u662FMicaps\u7B2C4\u7C7B\u6587\u4EF6\u683C\u5F0F";const a=[];for(let i=t.levelBegin;i<=t.levelEnd;i+=t.levelSpan)a.push(i);const c=new Array(t.countLat);for(let i=0;i<t.countLat;i++){let u=new Array(t.countLon);for(let d=0;d<t.countLon;d++)u[d]=parseFloat(e[o++]);c[i]=u}return{data:c,head:t,levels:a}}class bt{constructor(){r(this,"diamond","");r(this,"type",2);r(this,"name","");r(this,"year",2e3);r(this,"month",1);r(this,"day",1);r(this,"hour",0);r(this,"level",0);r(this,"count",0)}}class Et{constructor(){r(this,"iiiii","");r(this,"lon",0);r(this,"lat",0);r(this,"alt");r(this,"rank");r(this,"hh");r(this,"tt");r(this,"td");r(this,"dd");r(this,"ff")}toPorps(){return{iiiii:this.iiiii,alt:this.alt,rank:this.rank,hh:this.hh,tt:this.tt,td:this.td,dd:this.dd,ff:this.ff}}}class Pt extends j{constructor(){super();this.dataProjection=O("EPSG:4326")}readFeaturesFromText(e,t){const o=Ot(e),s=o.head,a=o.stations,c=new A;return a.forEach(i=>{let u=new S([i.lon,i.lat]);u=$(u,!1,t);const d=new N(u);d.setProperties(i.toPorps()),c.push(d)}),c.meta=s,c}}function Ot(n){const e=n.split(/[\s+\n+]+/),t=new bt;let o=0,s;for(s in t)t[s]=typeof t[s]=="number"?parseFloat(e[o]):e[o],o++;if(t.diamond!="diamond"||t.type!=2)throw"\u65E0\u6CD5\u89E3\u6790\u6570\u636E\u6587\u4EF6\uFF0C\u4E0D\u662FMicaps\u7B2C4\u7C7B\u6587\u4EF6\u683C\u5F0F";const a=new Array(t.count);o=9;for(let c=0;c<t.count;c++){const i=new Et;let u;for(u in i)i[u]=u==="iiiii"?e[o]:parseFloat(e[o]),o++;a[c]=i}return{stations:a,head:t}}class B extends mt{addFeatures(e){const t=e.meta;this.set("name",t.name),super.addFeatures(e)}}yt({colormap:"jet",nshades:256,format:"hex",alpha:1});const x="navy",R=new w({stroke:new y({color:x,width:1.2}),text:new g({font:"bold 12px tahoma",stroke:new y({color:"white"}),fill:new m({color:x}),placement:"line"})}),C=new w({text:new g({font:"bold 12px tahoma",stroke:new y({color:"white"}),fill:new m({color:x}),placement:"line"})}),G=C.clone(),I=C.clone();new w({fill:new m({color:"gray"}),stroke:new y({color:x,width:.3})});const z=new w({text:new g({text:"",font:"bold 24px tahoma",stroke:new y({color:"white"}),fill:new m({color:x}),offsetY:-10}),image:new k({radius:2,stroke:new y({color:"white"}),fill:new m({color:x})})}),U=new w({text:new g({font:"bold 13px tahoma",stroke:new y({color:"white"}),fill:new m({color:x}),offsetY:10})});var H;(function(n){n[n.FILL=0]="FILL",n[n.SOLID=1]="SOLID",n[n.COLOR=2]="COLOR"})(H||(H={}));function Mt(n){const e=Array(),t=n.getGeometry().getType().toUpperCase();if(!t)return e;const o=n.get("level");if(t.indexOf("LINE")>=0){R.getStroke().setLineDash(o<=0?[3,3]:[]),e.push(R),C.getText().setText(o.toFixed(0).toString()),e.push(C);const s=n.getGeometry();if(!n.get("close")&&s){const a=s.getFirstCoordinate(),c=s.getLastCoordinate();G.setGeometry(new S(a)),G.getText().setText(o.toString()),e.push(G),I.setGeometry(new S(c)),I.getText().setText(o.toString()),e.push(I)}}if(t.indexOf("POINT")>=0){const s=n.get("high")?"H":"L";z.getText().setText(s),e.push(z),U.getText().setText(o.toFixed(1).toString()),e.push(U)}return e}class At extends k{constructor(e){const t=e;super({radius:30,stroke:t.stroke,fill:t.fill,scale:t.scale!==void 0?t.scale:1,rotation:t.dd!==void 0?t.dd/180*Math.PI:0,rotateWithView:!0});r(this,"_dd",0);r(this,"_ff",0);r(this,"_canvas",null);this.setWind(t.dd,t.ff)}getImage(e){this._canvas||(this._canvas={});const t=this._getId();let o=this._canvas[t];if(!o){const s=this.createRenderOptions(),a=gt(s.size*e,s.size*e);this._draw(s,a,e),o=a.canvas,this._canvas[t]=o}return o}_draw(e,t,o){if(t.scale(o,o),t.translate(e.size/2,e.size/2),this.getFill()){t.strokeStyle=this.getFill().getColor(),t.lineWidth=1,this.createPath(t);const s=this.getStroke();s&&(t.shadowColor=s.getColor(),t.shadowBlur=1+s.getWidth()||1),t.stroke()}}createPath(e){return jt(e,this._dd,this._ff),this}setWind(e=0,t=0){return this._dd=Math.round(e),this._ff=Math.round(t),this.setRotation(this._dd/180*Math.PI),this}getWind(){return{dd:this._dd,ff:this._ff}}_getId(){let t=~~(this._ff/2+.5),o=~~(t/10),s=~~((t-o*10)/2),a=Math.round(t-o*10-s*2);return o*100+s*10+a}}function jt(n,e,t){if(t<.1||t>200)return;n.setLineDash([]);let o=22,s=10;n.moveTo(0,0),n.lineTo(0,-o);let a=~~(t/2+.5),c=~~(a/10),i=~~((a-c*10)/2),u=Math.round(a-c*10-i*2);for(let d=0;d<c;d++)n.moveTo(0,-o),n.lineTo(s,-o-2),n.lineTo(0,-o+4),o-=5;c>0&&(o-=3);for(let d=0;d<i;d++)n.moveTo(0,-o),n.lineTo(s,-o-6),o-=4;u>=1&&(n.moveTo(0,-o),n.lineTo(s/2,-o-3),o-=4)}const T=new y({width:1,color:"#8886"}),b="11px Times New Roman",X=new w({image:new At({stroke:T,fill:new m({color:"black"})})}),Bt=new w({image:new k({radius:2,stroke:new y({color:"black"})})}),J=new w({text:new g({fill:new m({color:"gray"}),stroke:T,offsetY:7,font:b})}),q=new w({text:new g({fill:new m({color:"navy"}),stroke:T,textAlign:"right",offsetX:-2,offsetY:-5,font:b})}),K=new w({text:new g({fill:new m({color:"red"}),stroke:T,font:b,textAlign:"left",offsetX:2,offsetY:-5})});new w({text:new g({fill:new m({color:"green"}),stroke:T,font:b,textAlign:"right",offsetX:-2,offsetY:5})});function Gt(n){const e=n.getProperties();if(!e)return[];const t=[Bt],o=e.name||e.iiiii;return o&&(J.getText().setText(o),t.push(J)),e.ff>0&&e.ff<=360&&(X.getImage().setWind(e.dd,e.ff),t.push(X)),e.hh>0&&e.hh<9990&&(q.getText().setText(e.hh.toString()),t.push(q)),e.tt>-200&&e.tt<9990&&(K.getText().setText(e.tt.toString()),t.push(K)),t}const It=new y({width:1,color:"#8888"}),Dt="11px Times New Roman",Q=new w({text:new g({fill:new m({color:"navy"}),stroke:It,font:Dt,offsetY:-8}),image:new k({radius:2,stroke:new y({color:"navy"})})});function Vt(n){const e=n.getProperties();if(!e)return[];const t=e.level;return Q.getText().setText(t.toString()),Q}const D=n=>(lt("data-v-8a09e650"),n=n(),ut(),n),Wt={ref:"'mapRef",class:"container"},$t={class:"leftside"},Nt={class:"cmbtree"},Yt=D(()=>f("br",null,null,-1)),Rt=D(()=>f("br",null,null,-1)),zt={class:"layerlist"},Ut=["onUpdate:modelValue"],Ht={class:"layer-name"},Xt=D(()=>f("br",null,null,-1)),Jt=et({setup(n){const e=V();let t;const o=new xt,s=h=>{const l=new M({style:Gt,source:new B({url:h,format:new Pt})});o.getLayers().push(l)},a=h=>{const l=new M({style:Mt,source:new B({url:h,format:new kt})});o.getLayers().push(l)},c=h=>{const l=new M({style:Vt,source:new B({url:h,format:new Lt})});o.getLayers().push(l)},i=()=>{o.getLayers().clear()},u=d(o);W(()=>{t=e.value.getMap(),t.addLayer(o),console.log("onMounted")});function d(h){const l=V(new Array),p=()=>{l.value=[],h.getLayersArray().forEach(v=>{var F;l.value.push({visible:v.getVisible(),name:((F=v.getSource())==null?void 0:F.get("name"))||"UnNamed"})})};return ot(l,()=>{h.getLayersArray().forEach((v,F)=>{v.setVisible(l.value[F].visible)})},{deep:!0}),W(()=>h.on("change",p)),nt(()=>h.un("change",p)),l}return(h,l)=>(E(),P("div",Wt,[f("div",$t,[f("div",Nt,[f("button",{onClick:l[0]||(l[0]=p=>s("./data/md2/10112608.000"))},"\u9AD8\u7A7A\u586B\u56FE1"),f("button",{onClick:l[1]||(l[1]=p=>s("./data/md2/10112708.000"))},"\u9AD8\u7A7A\u586B\u56FE2"),Yt,f("button",{onClick:l[2]||(l[2]=p=>a("./data/md4/10112608.000"))},"\u7B49\u503C\u7EBF1"),f("button",{onClick:l[3]||(l[3]=p=>a("./data/md4/10112708.000"))},"\u7B49\u503C\u7EBF2"),Rt,f("button",{onClick:l[4]||(l[4]=p=>c("./data/md4/10112608.000"))},"\u683C\u70B9\u503C1"),f("button",{onClick:l[5]||(l[5]=p=>c("./data/md4/10112708.000"))},"\u683C\u70B9\u503C2")]),f("div",zt,[(E(!0),P(st,null,rt(at(u),(p,v)=>(E(),P("div",{key:v},[ct(f("input",{type:"checkbox",class:"layer-visible","onUpdate:modelValue":F=>p.visible=F},null,8,Ut),[[dt,p.visible]]),f("span",Ht,pt(p.name),1)]))),128))]),Xt,f("button",{onClick:i},"\u6E05\u7A7A")]),it(vt,{class:"map",ref_key:"mapRef",ref:e},null,512)],512))}});var ee=_t(Jt,[["__scopeId","data-v-8a09e650"]]);export{ee as default};
